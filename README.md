# SatelliteBuildingArea
Определение площади застройки по спутниковому снимку.

Описание экспериментов
Ноутбук: 1. Buildings_ResNet

Цель. Обучить модель бинарной сегментации зданий (пиксельная маска 0/1) по спутниковым TIFF.

Данные. Датасет из пар images/*.tif и gt/*.tif (маски). Разбиение на train/val: 85/15, фиксированный seed.

Пайплайн данных.

Чтение больших TIFF “окнами” через rasterio (случайные патчи на лету).

Патч: 256×256.

Train: scale jitter 0.5–1.5 + аугментации (flip, rot90).

Val: без jitter и без аугментаций.

Нормализация изображения в [0,1], маска бинаризуется (0/255 → 0/1).

Модель. DeepLabV3-ResNet50 из torchvision, num_classes=1 (логиты для бинарной сегментации).

Функция потерь. BCEWithLogitsLoss(pos_weight=5) + DiceLoss (борьба с дисбалансом классов и оптимизация перекрытия).

Обучение.

AdamW(lr=5e-5, weight_decay=1e-4) (режим дообучения).

AMP (mixed precision) + gradient accumulation: batch=8, accum=4 (эффективный batch=32).

Gradient clipping: max_norm=1.0.

Resume из чекпойнтов best_model.pt / last_model.pt, сохранение лучшего по IoU.

Метрики. Precision, Recall, IoU, F1 (по пикселям) после пороговой бинаризации вероятностей.

Результаты (валидация).

При продолжении обучения качество держится примерно на уровне IoU ~0.72–0.74, F1 ~0.83–0.85.

Лучший чекпойнт: best_iou ≈ 0.749 (epoch 47 в сохранённом best).

Подбор порога для инференса.

Полный скан порогов на val показал лучший IoU при thr=0.78:
IoU=0.7413, P=0.834, R=0.870, F1=0.8514.

При thr=0.78 модель слегка завышает суммарную площадь зданий: Pred/GT ≈ 1.043 (≈ +4.3%).

Дополнительно. Сделан интерактивный просмотр примеров (ipywidgets): выбор best/last чекпойнта, настройка порога, визуализация GT/Pred/Overlay и сравнение площадей.
